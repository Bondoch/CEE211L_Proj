<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>

<ScrollPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.triage.controllers.DashboardHomeController"
            fitToWidth="true"
            style="-fx-background-color: #f5f7fa;">

    <VBox spacing="25" style="-fx-background-color: #f5f7fa;">
        <padding>
            <Insets top="30" right="30" bottom="30" left="30"/>
        </padding>

        <!-- Welcome Section -->
        <VBox spacing="8">
            <Label fx:id="welcomeLabel"
                   text="Welcome, Administrator"
                   style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
            <Label text="Here's what's happening today"
                   style="-fx-font-size: 14px; -fx-text-fill: #7f858c;"/>
        </VBox>

        <!-- ✅ CAPACITY ALERT BOX -->
        <VBox fx:id="capacityAlertBox"
              spacing="10"
              style="-fx-padding: 0;"/>

        <!-- ADMIN PANEL -->
        <VBox fx:id="adminPanel" spacing="20" visible="true" managed="true">

            <!-- Stats Cards Row -->
            <GridPane hgap="20" vgap="20">
                <columnConstraints>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                </columnConstraints>

                <!-- On Shift Staff Card -->
                <VBox GridPane.columnIndex="0" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <StackPane style="-fx-background-color: #e3f2fd;
                                          -fx-background-radius: 10;
                                          -fx-padding: 12;">
                            <FontIcon iconLiteral="fas-user-md" iconSize="24" iconColor="#2ca3fa"/>
                        </StackPane>
                        <VBox spacing="4">
                            <Label text="On Shift Staff"
                                   style="-fx-font-size: 13px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="adminStaffCountLabel"
                                   text="0"
                                   style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Admitted Patients Card -->
                <VBox GridPane.columnIndex="1" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <StackPane style="-fx-background-color: #e8f5e9;
                                          -fx-background-radius: 10;
                                          -fx-padding: 12;">
                            <FontIcon iconLiteral="fas-procedures" iconSize="24" iconColor="#5ba2f4"/>
                        </StackPane>
                        <VBox spacing="4">
                            <Label text="Admitted"
                                   style="-fx-font-size: 13px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="adminPatientsCountLabel"
                                   text="0"
                                   style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Critical Patients Card -->
                <VBox GridPane.columnIndex="2" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <StackPane style="-fx-background-color: #ffebee;
                                          -fx-background-radius: 10;
                                          -fx-padding: 12;">
                            <FontIcon iconLiteral="fas-heartbeat" iconSize="24" iconColor="#e74c3c"/>
                        </StackPane>
                        <VBox spacing="4">
                            <Label text="Critical"
                                   style="-fx-font-size: 13px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="adminCriticalCountLabel"
                                   text="0"
                                   style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Available Beds Card -->
                <VBox GridPane.columnIndex="3" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <StackPane style="-fx-background-color: #fff3e0;
                                          -fx-background-radius: 10;
                                          -fx-padding: 12;">
                            <FontIcon iconLiteral="fas-bed" iconSize="24" iconColor="#c9bbaa"/>
                        </StackPane>
                        <VBox spacing="4">
                            <Label text="Available Beds"
                                   style="-fx-font-size: 13px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="adminBedsCountLabel"
                                   text="0"
                                   style="-fx-font-size: 32px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

            </GridPane>

            <!-- ✨ Two Column Layout (Facility Status + Recent Activity) -->
            <GridPane hgap="20" vgap="20">
                <columnConstraints>
                    <ColumnConstraints percentWidth="50"/>
                    <ColumnConstraints percentWidth="50"/>
                </columnConstraints>

                <!-- ✨ Facility Capacity Overview -->
                <VBox GridPane.columnIndex="0" spacing="15"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-chart-bar" iconSize="18" iconColor="#2ca3fa"/>
                        <Label text="Facility Capacity"
                               style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                    </HBox>

                    <VBox fx:id="facilityCapacityContainer" spacing="12">
                        <!-- Dynamically populated -->
                    </VBox>
                </VBox>

                <!-- ✨ Recent Activity Feed -->
                <VBox GridPane.columnIndex="1" spacing="15"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 20;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="fas-clock" iconSize="18" iconColor="#2ca3fa"/>
                        <Label text="Recent Activity"
                               style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                    </HBox>

                    <ScrollPane fitToWidth="true" prefHeight="280" maxHeight="280"
                                style="-fx-background-color: transparent; -fx-background: transparent;">
                        <VBox fx:id="recentActivityContainer" spacing="10">
                            <!-- Dynamically populated -->
                        </VBox>
                    </ScrollPane>
                </VBox>
            </GridPane>

            <!-- ✨ Critical Patients Alert Section -->
            <VBox fx:id="criticalPatientsSection" spacing="15"
                  style="-fx-background-color: #ffffff;
                         -fx-background-radius: 12;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                         -fx-padding: 20;">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <FontIcon iconLiteral="fas-exclamation-triangle" iconSize="18" iconColor="#e74c3c"/>
                    <Label text="Critical Patients Requiring Attention"
                           style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label fx:id="criticalCountBadge"
                           text="0"
                           style="-fx-background-color: #ffebee;
                                  -fx-text-fill: #e74c3c;
                                  -fx-font-size: 14px;
                                  -fx-font-weight: bold;
                                  -fx-padding: 4 12;
                                  -fx-background-radius: 12;"/>
                </HBox>

                <FlowPane fx:id="criticalPatientsContainer" hgap="15" vgap="15">
                    <!-- Dynamically populated with patient cards -->
                </FlowPane>
            </VBox>

        </VBox>

        <!-- USER PANEL (Simplified View) -->
        <VBox fx:id="userPanel" spacing="20" visible="false" managed="false">

            <GridPane hgap="20" vgap="20">
                <columnConstraints>
                    <ColumnConstraints percentWidth="33.33"/>
                    <ColumnConstraints percentWidth="33.33"/>
                    <ColumnConstraints percentWidth="33.33"/>
                </columnConstraints>

                <!-- Admitted Patients -->
                <VBox GridPane.columnIndex="0" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 25;">
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <StackPane style="-fx-background-color: #e8f5e9;
                                          -fx-background-radius: 12;
                                          -fx-padding: 15;">
                            <FontIcon iconLiteral="fas-procedures" iconSize="28" iconColor="#5ba2f4"/>
                        </StackPane>
                        <VBox spacing="5">
                            <Label text="Admitted"
                                   style="-fx-font-size: 14px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="userPatientsCountLabel"
                                   text="0"
                                   style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Critical Patients -->
                <VBox GridPane.columnIndex="1" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 25;">
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <StackPane style="-fx-background-color: #ffebee;
                                          -fx-background-radius: 12;
                                          -fx-padding: 15;">
                            <FontIcon iconLiteral="fas-heartbeat" iconSize="28" iconColor="#e74c3c"/>
                        </StackPane>
                        <VBox spacing="5">
                            <Label text="Critical"
                                   style="-fx-font-size: 14px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="userCriticalCountLabel"
                                   text="0"
                                   style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Available Beds -->
                <VBox GridPane.columnIndex="2" spacing="12"
                      style="-fx-background-color: #ffffff;
                             -fx-background-radius: 12;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                             -fx-padding: 25;">
                    <HBox alignment="CENTER_LEFT" spacing="15">
                        <StackPane style="-fx-background-color: #fff3e0;
                                          -fx-background-radius: 12;
                                          -fx-padding: 15;">
                            <FontIcon iconLiteral="fas-bed" iconSize="28" iconColor="#c9bbaa"/>
                        </StackPane>
                        <VBox spacing="5">
                            <Label text="Available Beds"
                                   style="-fx-font-size: 14px; -fx-text-fill: #7f858c;"/>
                            <Label fx:id="userBedsCountLabel"
                                   text="0"
                                   style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                        </VBox>
                    </HBox>
                </VBox>

            </GridPane>

            <!-- ✨ User Panel Recent Activity -->
            <VBox spacing="15"
                  style="-fx-background-color: #ffffff;
                         -fx-background-radius: 12;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);
                         -fx-padding: 20;">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <FontIcon iconLiteral="fas-clock" iconSize="18" iconColor="#2ca3fa"/>
                    <Label text="Recent Activity"
                           style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>
                </HBox>

                <ScrollPane fitToWidth="true" prefHeight="200" maxHeight="200"
                            style="-fx-background-color: transparent; -fx-background: transparent;">
                    <VBox fx:id="userRecentActivityContainer" spacing="10">
                        <!-- Dynamically populated -->
                    </VBox>
                </ScrollPane>
            </VBox>

        </VBox>

    </VBox>

</ScrollPane>
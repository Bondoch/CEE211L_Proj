<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.FontIcon?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.triage.controllers.DashboardController"
            stylesheets="@dashboard.css">

    <!-- ========== TOP BAR ========== -->
    <top>
        <HBox prefHeight="65" alignment="CENTER_LEFT" spacing="20"
              style="-fx-background-color: linear-gradient(to right, #034c81, #2ca3fa);
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.15), 8, 0, 0, 2);">
            <padding>
                <Insets left="20" right="20"/>
            </padding>

            <!-- Menu Button -->
            <Button fx:id="menuButton"
                    onAction="#toggleSidebar"
                    style="-fx-background-color: rgba(255,255,255,0.2);
                           -fx-background-radius: 8;
                           -fx-cursor: hand;
                           -fx-padding: 8 12;">
                <graphic>
                    <FontIcon iconLiteral="fas-bars" iconSize="20" iconColor="white"/>
                </graphic>
            </Button>

            <!-- Title -->
            <HBox spacing="12" alignment="CENTER_LEFT">
                <FontIcon iconLiteral="fas-th-large" iconSize="20" iconColor="white" opacity="0.9"/>
                <Label fx:id="titleLabel"
                       text="Dashboard"
                       style="-fx-text-fill: white;
                              -fx-font-size: 22px;
                              -fx-font-weight: bold;"/>
            </HBox>

            <Region HBox.hgrow="ALWAYS"/>

            <!-- User Info -->
            <HBox spacing="15" alignment="CENTER">
                <VBox alignment="CENTER_RIGHT" spacing="2">
                    <Label text="Admin User"
                           style="-fx-text-fill: white;
                                  -fx-font-size: 13px;
                                  -fx-font-weight: bold;"/>
                    <Label text="Administrator"
                           style="-fx-text-fill: rgba(255,255,255,0.8);
                                  -fx-font-size: 11px;"/>
                </VBox>
                <StackPane style="-fx-background-color: rgba(255,255,255,0.2);
                                  -fx-background-radius: 20;
                                  -fx-padding: 10;">
                    <FontIcon iconLiteral="fas-user-circle" iconSize="24" iconColor="white"/>
                </StackPane>
            </HBox>
        </HBox>
    </top>

    <!-- ========== CENTER AREA ========== -->
    <center>
        <StackPane fx:id="contentWrapper">

            <!-- Main Content -->
            <BorderPane fx:id="contentArea"
                        style="-fx-background-color: #f5f7fa;"/>

            <!-- Overlay for sidebar -->
            <Pane fx:id="overlay"
                  visible="false"
                  managed="false"
                  style="-fx-background-color: rgba(0,0,0,0.4);"/>

            <!-- Logout Confirmation Panel -->
            <VBox fx:id="logoutPanel"
                  visible="false"
                  managed="false"
                  alignment="CENTER"
                  spacing="20"
                  prefWidth="380"
                  maxWidth="380"
                  prefHeight="220"
                  maxHeight="220"
                  style="-fx-background-color: white;
                         -fx-padding: 30;
                         -fx-background-radius: 16;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 25, 0, 0, 5);"
                  StackPane.alignment="CENTER">

                <FontIcon iconLiteral="fas-sign-out-alt" iconSize="48" iconColor="#034c81"/>

                <Label text="Confirm Logout"
                       style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: #034c81;"/>

                <Label text="Are you sure you want to log out?"
                       style="-fx-text-fill: #7f858c; -fx-font-size: 14px;"/>

                <HBox spacing="15" alignment="CENTER">
                    <Button text="Cancel"
                            onAction="#cancelLogout"
                            prefWidth="140" prefHeight="42"
                            style="-fx-background-color: #e8e8e8;
                                   -fx-text-fill: #555;
                                   -fx-font-size: 14px;
                                   -fx-font-weight: bold;
                                   -fx-background-radius: 8;
                                   -fx-cursor: hand;"/>

                    <Button text="Logout"
                            onAction="#performLogout"
                            prefWidth="140" prefHeight="42"
                            style="-fx-background-color: linear-gradient(to right, #E74C3C, #C0392B);
                                   -fx-text-fill: white;
                                   -fx-font-size: 14px;
                                   -fx-font-weight: bold;
                                   -fx-background-radius: 8;
                                   -fx-cursor: hand;
                                   -fx-effect: dropshadow(gaussian, rgba(231,76,60,0.3), 10, 0, 0, 3);"/>
                </HBox>
            </VBox>

            <!-- ========== SIDEBAR ========== -->
            <VBox fx:id="sidebar"
                  prefWidth="240"
                  maxWidth="240"
                  minWidth="240"
                  style="-fx-background-color: linear-gradient(to bottom, #2C3E50, #34495E);
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 15, 0, 3, 0);"
                  StackPane.alignment="CENTER_LEFT">

                <padding>
                    <Insets top="20" bottom="20"/>
                </padding>

                <!-- Logo/Brand -->
                <VBox spacing="8" alignment="CENTER">
                    <StackPane style="-fx-background-color: rgba(255,255,255,0.1);
                                      -fx-background-radius: 50;
                                      -fx-padding: 15;">
                        <FontIcon iconLiteral="fas-heartbeat" iconSize="32" iconColor="white"/>
                    </StackPane>
                    <Label text="LifeLine"
                           style="-fx-text-fill: white;
                                  -fx-font-size: 18px;
                                  -fx-font-weight: bold;"/>
                    <Label text="Triage System"
                           style="-fx-text-fill: rgba(255,255,255,0.7);
                                  -fx-font-size: 12px;"/>
                </VBox>

                <Separator style="-fx-background-color: rgba(255,255,255,0.2);">
                    <VBox.margin>
                        <Insets top="20" bottom="10"/>
                    </VBox.margin>
                </Separator>

                <!-- Menu Items -->
                <VBox spacing="4">
                    <VBox.margin>
                        <Insets left="10" right="10"/>
                    </VBox.margin>

                    <HBox fx:id="itemDashboard" styleClass="menu-item" spacing="15" alignment="CENTER_LEFT">
                        <StackPane prefWidth="24" alignment="CENTER">
                            <FontIcon iconLiteral="fas-th-large" iconSize="16" iconColor="white"/>
                        </StackPane>
                        <Label text="Dashboard" styleClass="menu-text"/>
                    </HBox>

                    <HBox fx:id="itemStaff" styleClass="menu-item" spacing="15" alignment="CENTER_LEFT">
                        <StackPane prefWidth="24" alignment="CENTER">
                            <FontIcon iconLiteral="fas-user-md" iconSize="16" iconColor="white"/>
                        </StackPane>
                        <Label text="Staff Accounts" styleClass="menu-text"/>
                    </HBox>

                    <HBox fx:id="itemPatients" styleClass="menu-item" spacing="15" alignment="CENTER_LEFT">
                        <StackPane prefWidth="24" alignment="CENTER">
                            <FontIcon iconLiteral="fas-procedures" iconSize="16" iconColor="white"/>
                        </StackPane>
                        <Label text="Patients" styleClass="menu-text"/>
                    </HBox>

                    <HBox fx:id="itemFacilities" styleClass="menu-item" spacing="15" alignment="CENTER_LEFT">
                        <StackPane prefWidth="24" alignment="CENTER">
                            <FontIcon iconLiteral="fas-hospital" iconSize="16" iconColor="white"/>
                        </StackPane>
                        <Label text="Facilities" styleClass="menu-text"/>
                    </HBox>

                    <HBox fx:id="itemSettings" styleClass="menu-item" spacing="15" alignment="CENTER_LEFT">
                        <StackPane prefWidth="24" alignment="CENTER">
                            <FontIcon iconLiteral="fas-cog" iconSize="16" iconColor="white"/>
                        </StackPane>
                        <Label text="Settings" styleClass="menu-text"/>
                    </HBox>
                </VBox>

                <Region VBox.vgrow="ALWAYS"/>

                <!-- Logout Button -->
                <HBox fx:id="itemLogout"
                      styleClass="menu-item logout-item"
                      spacing="15" alignment="CENTER_LEFT"
                      onMouseClicked="#handleLogout">
                    <HBox.margin>
                        <Insets left="10" right="10"/>
                    </HBox.margin>
                    <StackPane prefWidth="24" alignment="CENTER">
                        <FontIcon iconLiteral="fas-sign-out-alt" iconSize="16" iconColor="#E74C3C"/>
                    </StackPane>
                    <Label text="Logout" styleClass="menu-text" style="-fx-text-fill: #E74C3C;"/>
                </HBox>

            </VBox>
        </StackPane>
    </center>
</BorderPane>
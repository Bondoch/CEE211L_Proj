<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>
<?import org.kordamp.ikonli.javafx.*?>

<HBox prefHeight="700" prefWidth="1200" style="-fx-background-color: #FFFFFF;" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.triage.controllers.LoginController">
    <!-- ========== LEFT SIDE: BRANDING/VISUAL ========== -->
    <AnchorPane maxWidth="800" minWidth="400" prefWidth="600" style="-fx-background-color: linear-gradient(to bottom, #034c81, #2ca3fa); -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 20, 0, 5, 0);" HBox.hgrow="ALWAYS">
        <!-- Medical Cross Icon -->
        <StackPane AnchorPane.leftAnchor="150" AnchorPane.topAnchor="180" />
        <!-- System Name -->
        <VBox alignment="CENTER_LEFT" spacing="15" AnchorPane.leftAnchor="80" AnchorPane.rightAnchor="80" AnchorPane.topAnchor="340">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Region prefHeight="3" prefWidth="50" style="-fx-background-color: #FFFFFF; -fx-background-radius: 2;" />
            </HBox>
            <Text style="-fx-font-size: 20px; -fx-fill: #FFFFFF; -fx-opacity: 0.9;" text="Triage Management System" />
        </VBox>
        <!-- Bottom Info -->
        <HBox alignment="CENTER" spacing="8" AnchorPane.bottomAnchor="50" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0">
            <FontIcon iconColor="#FFFFFF" iconLiteral="fas-shield-alt" iconSize="16" opacity="0.7" />
            <Text style="-fx-font-size: 13px; -fx-fill: #FFFFFF; -fx-opacity: 0.7;" text="Secure Healthcare Portal" />
        </HBox>
        <FontIcon iconColor="#FFFFFF" iconLiteral="fas-plus" iconSize="100" layoutX="431.0" layoutY="343.0" opacity="0.9" />
        <Circle fill="#FFFFFF" layoutX="475.0" layoutY="306.0" opacity="0.15" radius="80" />
        <Text layoutX="80.0" layoutY="325.0" style="-fx-font-size: 48px; -fx-font-weight: bold; -fx-fill: #FFFFFF;" text="LifeLine">
            <font>
                <Font name="System Bold" size="48" />
            </font>
        </Text>
        <Text layoutX="80.0" layoutY="413.0" style="-fx-font-size: 16px; -fx-fill: #FFFFFF; -fx-opacity: 0.8; -fx-font-style: italic;" text="Prioritizing Care, Saving Lives" />
    </AnchorPane>
    <!-- ========== RIGHT SIDE: LOGIN FORM ========== -->
    <StackPane style="-fx-background-color: #FFFFFF;"
               prefWidth="520"
               minWidth="520"
               maxWidth="520">
        <VBox alignment="CENTER" maxWidth="480" spacing="35">
            <padding>
                <Insets left="50" right="50" />
            </padding>

            <VBox alignment="CENTER" spacing="8">
                <Text style="-fx-font-size: 36px; -fx-font-weight: bold; -fx-fill: #034c81;" text="Welcome Back" />
                <Text style="-fx-font-size: 14px; -fx-fill: #7f858c;" text="Please sign in to continue" />
            </VBox>
            <VBox spacing="25" style="-fx-background-color: #FFFFFF;
             -fx-background-radius: 12;
             -fx-border-color: #e8e8e8;
             -fx-border-width: 1;
             -fx-border-radius: 12;
             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 15, 0, 0, 3);">
                <padding>
                    <Insets bottom="40" left="40" right="40" top="40" />
                </padding>
                <VBox spacing="8">
                    <Label style="-fx-text-fill: #034c81; -fx-font-size: 13px; -fx-font-weight: bold;" text="Username" />
                    <HBox alignment="CENTER_LEFT" spacing="0" style="-fx-background-color: #f8f9fa;                                  -fx-border-color: #e0e0e0;                                  -fx-border-radius: 8;                                  -fx-background-radius: 8;">
                        <StackPane alignment="CENTER" prefHeight="48" prefWidth="45">
                            <FontIcon iconColor="#7f858c" iconLiteral="fas-user" iconSize="18" />
                        </StackPane>
                        <TextField fx:id="usernameField" maxWidth="Infinity" prefHeight="48" promptText="Enter your username" style="-fx-background-color: transparent;                                           -fx-border-color: transparent;                                           -fx-background-radius: 0 8 8 0;                                           -fx-prompt-text-fill: #adb5bd;                                           -fx-text-fill: #034c81;                                           -fx-font-size: 14px;" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets right="15" />
                            </padding>
                        </TextField>
                    </HBox>
                </VBox>

                <VBox spacing="8">
                    <Label style="-fx-text-fill: #034c81; -fx-font-size: 13px; -fx-font-weight: bold;" text="Password" />
                    <HBox alignment="CENTER_LEFT" spacing="0" style="-fx-background-color: #f8f9fa;                                  -fx-border-color: #e0e0e0;                                  -fx-border-radius: 8;                                  -fx-background-radius: 8;">
                        <StackPane alignment="CENTER" prefHeight="48" prefWidth="45">
                            <FontIcon iconColor="#7f858c" iconLiteral="fas-lock" iconSize="18" />
                        </StackPane>
                        <PasswordField fx:id="passwordField" maxWidth="Infinity" prefHeight="48" promptText="Enter your password" style="-fx-background-color: transparent;                                               -fx-border-color: transparent;                                               -fx-background-radius: 0 8 8 0;                                               -fx-prompt-text-fill: #adb5bd;                                               -fx-text-fill: #034c81;                                               -fx-font-size: 14px;" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets right="15" />
                            </padding>
                        </PasswordField>
                    </HBox>
                </VBox>

                <HBox alignment="CENTER_LEFT" spacing="10">
                    <CheckBox fx:id="rememberMeCheckBox"
                              style="-fx-text-fill: #7f858c; -fx-font-size: 13px;"
                              text="Remember me" />
                    <Region HBox.hgrow="ALWAYS" />
                    <Button text="Create Account"
                            onAction="#onCreateAccountClick"
                            style="-fx-background-color: transparent;
                   -fx-text-fill: #2ca3fa;
                   -fx-font-size: 13px;
                   -fx-padding: 0;
                   -fx-cursor: hand;" />
                </HBox>
                <!-- Login Button -->
                <Button maxWidth="Infinity" onAction="#onLoginButtonClick" prefHeight="52" style="-fx-background-color: linear-gradient(to right, #2ca3fa, #5ba2f4);                                -fx-text-fill: white;                                -fx-font-size: 16px;                                -fx-font-weight: bold;                                -fx-background-radius: 10;                                -fx-cursor: hand;                                -fx-effect: dropshadow(gaussian, rgba(44,163,250,0.3), 10, 0, 0, 3);">
                    <graphic>
                        <HBox alignment="CENTER" spacing="10">
                            <Label style="-fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold;" text="Sign In" />
                            <FontIcon iconColor="white" iconLiteral="fas-arrow-right" iconSize="16" />
                        </HBox>
                    </graphic>
                </Button>
                <!-- Error Label -->
                <HBox fx:id="errorContainer" alignment="CENTER_LEFT" managed="false" spacing="10" style="-fx-background-color: #fff3f3;                              -fx-border-color: #ff6b6b;                              -fx-border-width: 1;                              -fx-border-radius: 6;                              -fx-background-radius: 6;                              -fx-padding: 12;" visible="false">
                    <FontIcon iconColor="#ff6b6b" iconLiteral="fas-exclamation-circle" iconSize="16" />
                    <Label fx:id="errorLabel" maxWidth="Infinity" style="-fx-text-fill: #ff6b6b; -fx-font-size: 13px;" wrapText="true" HBox.hgrow="ALWAYS" />
                </HBox>
            </VBox>
            <!-- Additional Info -->
            <HBox alignment="CENTER" spacing="5">
                <Text style="-fx-font-size: 13px; -fx-fill: #7f858c;" text="Need help?" />
                <Hyperlink style="-fx-text-fill: #2ca3fa; -fx-font-size: 13px;" text="Contact IT Support" />
            </HBox>
            <!-- Version Info -->
            <HBox alignment="CENTER" spacing="8">
                <FontIcon iconColor="#c9bbaa" iconLiteral="fas-info-circle" iconSize="12" />
                <Text style="-fx-font-size: 11px; -fx-fill: #c9bbaa;" text="Version 1.0.0" />
                <Text style="-fx-font-size: 11px; -fx-fill: #c9bbaa;" text="•" />
                <Text style="-fx-font-size: 11px; -fx-fill: #c9bbaa;" text="© 2024 LifeLine Healthcare" />
            </HBox>
        </VBox>
        <!-- ===== ADMIN SETUP OVERLAY BACKDROP ===== -->
        <Pane fx:id="adminSetupBackdrop"
              visible="false"
              managed="false"
              style="-fx-background-color: rgba(0,0,0,0.35);"
              StackPane.alignment="CENTER"/>

        <!-- ===== ADMIN SETUP CARD ===== -->
        <VBox fx:id="adminSetupCard"
              visible="false"
              managed="false"
              spacing="18"
              prefWidth="420"
              maxWidth="420"
              maxHeight="360"
              StackPane.alignment="CENTER"
              style="-fx-background-color: white;
             -fx-background-radius: 18;
             -fx-padding: 22 22 20 22;
             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.25), 20, 0, 0, 5);">
        <!-- ===== HEADER ===== -->
            <VBox spacing="4">
                <Label text="Initial Administrator Setup"
                       style="-fx-font-size: 18px;
                      -fx-font-weight: bold;
                      -fx-text-fill: #034c81;"/>
                <Label text="Create the primary admin account"
                       style="-fx-font-size: 12px;
                      -fx-text-fill: #7f858c;"/>
            </VBox>
            <Separator style="-fx-background-color: #e8e8e8;"/>
            <!-- ===== FORM ===== -->
            <VBox spacing="12">
                <TextField fx:id="adminUsernameField"
                           promptText="Admin Username"
                           style="-fx-background-color: #f8f9fa;
                          -fx-border-color: #e0e0e0;
                          -fx-border-radius: 8;
                          -fx-background-radius: 8;
                          -fx-font-size: 13px;"/>
                <PasswordField fx:id="adminPasswordField"
                               promptText="Password"
                               style="-fx-background-color: #f8f9fa;
                              -fx-border-color: #e0e0e0;
                              -fx-border-radius: 8;
                              -fx-background-radius: 8;
                              -fx-font-size: 13px;"/>
                <PasswordField fx:id="adminConfirmField"
                               promptText="Confirm Password"
                               style="-fx-background-color: #f8f9fa;
                              -fx-border-color: #e0e0e0;
                              -fx-border-radius: 8;
                              -fx-background-radius: 8;
                              -fx-font-size: 13px;"/>
            </VBox>
            <!-- ===== ERROR ===== -->
            <Label fx:id="adminSetupErrorLabel"
                   visible="false"
                   managed="false"
                   style="-fx-text-fill: #ff6b6b;
                  -fx-font-size: 12px;"/>
            <Separator style="-fx-background-color: #e8e8e8;"/>
            <!-- ===== ACTIONS ===== -->
            <HBox spacing="10" alignment="CENTER_RIGHT">
                <!-- Cancel -->
                <Button text="Cancel"
                        onAction="#hideAdminSetup"
                        style="-fx-background-color: #f8f9fa;
                       -fx-text-fill: #034c81;
                       -fx-font-size: 13px;
                       -fx-background-radius: 18;
                       -fx-border-color: #e0e0e0;
                       -fx-border-radius: 18;
                       -fx-cursor: hand;"/>
                <!-- Create -->
                <Button text="Create Admin"
                        onAction="#handleCreateAdminOverlay"
                        style="-fx-background-color: linear-gradient(to right, #2ca3fa, #5ba2f4);
                       -fx-text-fill: white;
                       -fx-font-size: 13px;
                       -fx-font-weight: bold;
                       -fx-background-radius: 18;
                       -fx-cursor: hand;
                       -fx-effect: dropshadow(gaussian, rgba(44,163,250,0.35), 8, 0, 0, 2);"/>
            </HBox>
        </VBox>
    </StackPane>
</HBox>
